@model LHOfficeBgo.ViewModel.Content.IndexMenusEntityVMs.IndexMenusEntityListVM
<wt:searchpanel vm="@Model" reset-btn="true">
<wt:row items-per-row="ItemsPerRowEnum.Three">
</wt:row>
</wt:searchpanel>
<wt:grid vm="@Model" parent-id="@Model.ParentId"/>

<script>


    var LhIndexMenus = {

        ReDirectUrl: function (url) {
            window.location.href = url;

        },
        deleteImg: function (obj) {
            $(obj).closest(".layui-row ").remove();
        },
        initUploadObj: function (id) {

            var index = 0;

            //普通图片上传
            var uploadInst = layui.upload.render({
                elem: '#' + id
                , url: '/_Framework/UploadImage?1=1&_DONOT_USE_CS=default&saveInDb=false'
                , size: 0
                , accept: 'file'
                , exts: 'jpg|jpeg|gif|bmp|png|tif'
                , before: function (obj) {
                    index = layui.layer.load(2);
                }
                , done: function (res) {
                    layui.layer.close(index);
                    if (res.Data.Id == '') {

                        layui.layer.msg('上传失败');
                    }
                    else {
                        var section = this.item.data().section;
                        if (section == "DefaultImg") {
                            $("#IndexMenusEntityVM_Entity_DefaultImg").val(res.Data.Url);
                            $("#EntityDefaultImgDetail").attr("src", res.Data.Url);
                        } else if (section == "HoverImg") {
                            $("#IndexMenusEntityVM_Entity_HoverImg").val(res.Data.Url);
                            $("#EntityHoverImgDetail").attr("src", res.Data.Url);
                        }          

                    }
                }
                , error: function () {
                    layui.layer.close(index);
                }
            });
        },
        init: function () {
            var uploadFileButtons = $("#imgsSection button[name='Entity.ImgsUploadButton'").each(function (index, item) {
                LhIndexMenus.initUploadObj(item.id);
            });



        },



    };


</script>
